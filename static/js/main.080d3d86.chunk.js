(this["webpackJsonpreact-complete-project"]=this["webpackJsonpreact-complete-project"]||[]).push([[0],{17:function(e,t,n){},25:function(e,t,n){e.exports=n(38)},30:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),c=n(18),l=n.n(c),r=(n(30),n(1)),i=n(8),s=n(10),m=n(11),u=n(14),h=n(12),f=n(15),d=n(5),v=n(13),E=n.n(v);n(17);function N(){return new Promise((function(e,t){console.log("1. Get auth token from Microsoft Teams"),d.authentication.getAuthToken({successCallback:function(t){e(t)},failureCallback:function(e){t("Error getting token: "+e),console.log("Error getting token")}})}))}function p(e){return new Promise((function(t,n){d.getContext((function(a){(function(e,t){var n=e.tid,a=t,o=["https://graph.microsoft.com/User.Read"];return new Promise((function(e,t){var c="https://login.microsoftonline.com/"+n+"/oauth2/v2.0/token",l={client_id:"630f584b-b191-409e-a327-e0d185632359",client_secret:"91M_kPSR6h4-jhGl7disIg_bwhNcBXvAS~",grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:a,requested_token_use:"on_behalf_of",scope:o.join(" ")};fetch(c,{method:"POST",body:E.a.stringify(l),headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}}).then((function(n){200!==n.status?n.json().then((function(e){t({error:e.error})})):n.json().then((function(t){e(t.access_token)}))}))}))})(a,e).then((function(e){if(e.ok)return e.json();n(e.error)})).then((function(e){e.error?n(e.error):t(e)}))}))}))}var k=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={client_token:"client token",server_token:"server token",profile:{},theme:"theme",name:"name",context:{}},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;d.initialize(),d.getContext((function(t){t&&t.theme?(console.log(t),e.setState({theme:t.theme,context:t})):console.log("no theme")})),N().then((function(t){return console.log(t),e.setState((function(e,n){return{client_token:t}})),p(t)})).then((function(t){console.log(t),e.setState((function(e,n){return{server_token:t}}))})).catch((function(e){console.log(e),alert("you are not in the MS teams App")}))}},{key:"gettokenDetails",value:function(){var e=this;this.setState({client_token:"tt"}),N().then((function(t){return console.log(t),e.setState((function(e,n){return{client_token:t}})),p(t)})).then((function(t){console.log(t),e.setState((function(e,n){return{server_token:t}}))})).catch((function(e){console.log(e),alert("you are not in the MS teams App")}))}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"container"},o.a.createElement("h5",{className:"text-left"},"Demo tokens and profile")),o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-3"},"Theme"),o.a.createElement("div",{className:"col-sm-9"},this.state.theme)),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-3"},"host Client Type"),o.a.createElement("div",{className:"col-sm-9"},this.state.context.hostClientType)),o.a.createElement("br",null),o.a.createElement("div",{className:"container"},o.a.createElement("h5",{className:"text-left"},"Profile")),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-3"},o.a.createElement("p",null,"Name:"),o.a.createElement("p",null,"Email:"),o.a.createElement("p",null,"id:")),o.a.createElement("div",{className:"col-sm-9"},o.a.createElement("p",null,this.state.context.teamSiteDomain),o.a.createElement("p",null,this.state.context.upn),o.a.createElement("p",null,this.state.context.tid))),o.a.createElement("button",null,"Get token"),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-3"},"client token"),o.a.createElement("div",{className:"col-sm-9"},this.state.client_token)),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-3"},"server token"),o.a.createElement("div",{className:"col-sm-9"},this.state.server_token))))}}]),t}(o.a.Component);function g(e,t){var n=["https://graph.microsoft.com/User.Read"];return new Promise((function(e,t){var a={client_id:"630f584b-b191-409e-a327-e0d185632359",client_secret:"91M_kPSR6h4-jhGl7disIg_bwhNcBXvAS~",grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyJ9.eyJhdWQiOiI2MzBmNTg0Yi1iMTkxLTQwOWUtYTMyNy1lMGQxODU2MzIzNTkiLCJpc3MiOiJodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vNjQ3ZTllNzAtZWM2ZC00M2ZjLTg5NjItODkyZjkxMzU2NTIxL3YyLjAiLCJpYXQiOjE2MjI2MzI0OTEsIm5iZiI6MTYyMjYzMjQ5MSwiZXhwIjoxNjIyNjM5OTkxLCJhaW8iOiJBVlFBcS84VEFBQUFrMlUyQ1pBNFR0Skk5YWxUUll1MGxvT2VmLzFhOE10OUg0c0Z0M2lzV2pjVHdHTEFtQ3JNZkkvSDZwK1RsMnpnQnRvRVdRSVcvcnh0Q0hTQVBVUjZaTDhDNTZJOUM5Qm03VlVMcFVPOUExRT0iLCJhenAiOiI1ZTNjZTZjMC0yYjFmLTQyODUtOGQ0Yi03NWVlNzg3ODczNDYiLCJhenBhY3IiOiIwIiwibmFtZSI6IkNoYW5ha2EgU2FuamVld2EiLCJvaWQiOiIzNmMyNDY5ZS02N2Y2LTRkM2QtYTYyMS0zOTg3NWFiNDQ3MDUiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJDaGFuYWthQG9uc2hvcGxrLm9ubWljcm9zb2Z0LmNvbSIsInJoIjoiMC5BWEFBY0o1LVpHM3NfRU9KWW9rdmtUVmxJY0RtUEY0Zks0VkNqVXQxN25oNGMwWndBSVEuIiwic2NwIjoiYWNjZXNzX2FzX3VzZXIiLCJzdWIiOiJibXlmTk15aDhWOFRpSWlNNGt0TnlCTmpReVRzakZUUmRMTEdPaVp3d0pVIiwidGlkIjoiNjQ3ZTllNzAtZWM2ZC00M2ZjLTg5NjItODkyZjkxMzU2NTIxIiwidXRpIjoic01BdXhlU2piRUNuOWdDY2xLNDVBdyIsInZlciI6IjIuMCJ9.Q7A4VL4Ys8Osx0JVaxv8LD1uq0JUzkxzU6uwUC6EomkOGFteRTlNPWzTatm8vVSCEUzztKPiXXsiBxufPH7f5vMhyptGQ3HZ2PGnMAPgxZgRExfgzPHG03wjivOx74BDN_HEFZVhlJ1dun3VjN2oWP1yzz6dAfVxay5ZFu45xJyhKYz-emxYRRpcvwPJh35TccofSmKMR082MVknP-xMKAwGn2FfK3eBis25F7UMJDFwTORLT8Owr1lx5IGz-JO1zCdIuvhHL-LoTi30xDAlmCXuXRE00zlJAfQOFQ4ZvYj3EK79GpYNYK19AZjBqRFd2_UFU2TAXG3etE8OqFEEsg",requested_token_use:"on_behalf_of",scope:n.join(" ")};console.log(a),fetch("https://login.microsoftonline.com/647e9e70-ec6d-43fc-8962-892f91356521/oauth2/v2.0/token",{method:"POST",body:E.a.stringify(a),headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}}).then((function(n){200!==n.status?n.json().then((function(e){t({error:e.error})})):n.json().then((function(t){console.log(t.access_token),e(t.access_token)}))}))}))}var b=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={client_token:"client token",server_token:"server token",profile:{},theme:"theme"},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;d.initialize(),d.getContext((function(e){e&&e.theme?(console.log(e),this.setState({theme:e.theme})):console.log("no theme")})),g().then((function(e){e.ok?console.log(e.json()):console.log(e.error)})),new Promise((function(e,t){console.log("1. Get auth token from Microsoft Teams"),d.authentication.getAuthToken({successCallback:function(t){e(t)},failureCallback:function(e){t("Error getting token: "+e),console.log("Error getting token")}})})).then((function(t){return e.setState((function(e,n){return{client_token:t}})),new Promise((function(e,t){d.getContext((function(n){g().then((function(e){if(e.ok)return e.json();t(e.error)})).then((function(n){n.error?t(n.error):e(n)}))}))}))})).then((function(t){return console.log(t),e.setState((function(e,n){return{server_token:t}})),fetch("https://graph.microsoft.com/v1.0/me/",{method:"GET",headers:{accept:"application/json",authorization:"bearer "+t},mode:"cors",cache:"default"}).then((function(e){if(e.ok)return e.json();throw"Error ".concat(e.status,": ").concat(e.statusText)})).then((function(e){return e}))})).then((function(t){console.log(t),e.setState((function(e,n){return{profile:t}}))})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"container"},o.a.createElement("h5",{className:"text-left"},"Local Demo 2 tokens")),o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-3"},"Theme"),o.a.createElement("div",{className:"col-sm-9"},this.state.theme)),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-3"},"client token"),o.a.createElement("div",{className:"col-sm-9"},this.state.client_token)),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-3"},"server token"),o.a.createElement("div",{className:"col-sm-9"},this.state.server_token)),o.a.createElement("br",null),o.a.createElement("div",{className:"container"},o.a.createElement("h5",{className:"text-left"},"Profile")),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-3"},o.a.createElement("p",null,"Name:"),o.a.createElement("p",null,"Email:"),o.a.createElement("p",null,"id:")),o.a.createElement("div",{className:"col-sm-9"},o.a.createElement("p",null,this.state.profile.displayName),o.a.createElement("p",null,this.state.profile.mail),o.a.createElement("p",null,this.state.profile.id)))))}}]),t}(o.a.Component);function j(){var e=Object(r.f)().slug;return o.a.createElement("div",null,"Now showing post ",e)}var w=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(i.a,null,o.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},o.a.createElement("div",{className:"container-fluid"},o.a.createElement(i.b,{className:"navbar-brand",to:"/"},"Hsenid Biz"),o.a.createElement("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},o.a.createElement("span",{className:"navbar-toggler-icon"})),o.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNav"},o.a.createElement("ul",{className:"navbar-nav"},o.a.createElement("li",{className:"nav-item"},o.a.createElement(i.b,{className:"nav-link",to:"/React-h-biz"},"Home")),o.a.createElement("li",{className:"nav-item"},o.a.createElement(i.b,{className:"nav-link",to:"/React-h-biz/demo2"},"Demo2")),o.a.createElement("li",{className:"nav-item"},o.a.createElement(i.b,{className:"nav-link",to:"/config/:slug"},"Config")),o.a.createElement("li",{className:"nav-item"},o.a.createElement("a",{className:"nav-link disabled",href:"#",tabindex:"-1","aria-disabled":"true"},"Disabled")))))),o.a.createElement(r.c,null,o.a.createElement(r.a,{exact:!0,path:"/React-h-biz"},o.a.createElement(k,null)),o.a.createElement(r.a,{exact:!0,path:"/React-h-biz/demo2"},o.a.createElement(b,null)),o.a.createElement(r.a,{path:"config/:slug"},o.a.createElement(j,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(w,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[25,1,2]]]);
//# sourceMappingURL=main.080d3d86.chunk.js.map