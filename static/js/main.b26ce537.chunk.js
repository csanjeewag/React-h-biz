(this["webpackJsonpreact-complete-project"]=this["webpackJsonpreact-complete-project"]||[]).push([[0],{15:function(e,t,a){},28:function(e,t,a){e.exports=a(41)},33:function(e,t,a){},41:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),o=a(21),c=a.n(o),s=(a(33),a(1)),r=a(17),i=a(7),m=a(8),u=a(10),d=a(9),h=a(11),f=a(3),E=a(6),p=a.n(E);a(15);function v(){return new Promise((function(e,t){console.log("1. Get auth token from Microsoft Teams"),f.authentication.getAuthToken({successCallback:function(t){e(t)},failureCallback:function(e){t("Error getting token: "+e),console.log("Error getting token")}})}))}function N(e){return console.log("2. Exchange for server-side token"),new Promise((function(t,a){f.getContext((function(n){fetch("http://localhost:3333/auth/token",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({tid:n.tid,token:e}),mode:"cors",cache:"default"}).then((function(e){if(e.ok)return e.json();a(e.error)})).then((function(e){if(e.error)a(e.error);else{var n=e;console.log(n),t(n)}}))}))}))}var g=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={client_token:"client token",server_token:"server token",profile:{},theme:"theme",name:"name",context:{}},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;f.initialize(),f.getContext((function(t){t&&t.theme?(console.log(t),e.setState({theme:t.theme,context:t})):console.log("no theme")})),v().then((function(t){return console.log(t),e.setState((function(e,a){return{client_token:t}})),N(t)})).then((function(t){console.log("serverSideToken"),console.log(t),e.setState((function(e,a){return{server_token:t}}))})).catch((function(e){console.log(e),alert("you are not in the MS teams App")}))}},{key:"gettokenDetails",value:function(){var e=this;this.setState({client_token:"tt"}),v().then((function(t){return console.log(t),e.setState((function(e,a){return{client_token:t}})),N(t)})).then((function(t){console.log(t),e.setState((function(e,a){return{server_token:t}}))})).catch((function(e){console.log(e),alert("you are not in the MS teams App")}))}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("div",{className:"container"},l.a.createElement("h5",{className:"text-left"},"Demo tokens and profile Details 3")),l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},"Theme"),l.a.createElement("div",{className:"col-sm-9"},this.state.theme)),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},"host Client Type"),l.a.createElement("div",{className:"col-sm-9"},this.state.context.hostClientType)),l.a.createElement("br",null),l.a.createElement("div",{className:"container"},l.a.createElement("h5",{className:"text-left"},"Profile")),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("p",null,"Name:"),l.a.createElement("p",null,"Email:"),l.a.createElement("p",null,"id:")),l.a.createElement("div",{className:"col-sm-9"},l.a.createElement("p",null,this.state.context.teamSiteDomain),l.a.createElement("p",null,this.state.context.upn),l.a.createElement("p",null,this.state.context.tid))),l.a.createElement("button",null,"Get token"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},"client token"),l.a.createElement("div",{className:"col-sm-9"},this.state.client_token)),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},"server token"),l.a.createElement("div",{className:"col-sm-9"},this.state.server_token))))}}]),t}(l.a.Component);function b(e,t){var a=["https://graph.microsoft.com/User.Read"];return new Promise((function(e,t){var n={client_id:"630f584b-b191-409e-a327-e0d185632359",client_secret:"91M_kPSR6h4-jhGl7disIg_bwhNcBXvAS~",grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyJ9.eyJhdWQiOiI2MzBmNTg0Yi1iMTkxLTQwOWUtYTMyNy1lMGQxODU2MzIzNTkiLCJpc3MiOiJodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vNjQ3ZTllNzAtZWM2ZC00M2ZjLTg5NjItODkyZjkxMzU2NTIxL3YyLjAiLCJpYXQiOjE2MjI2MzI0OTEsIm5iZiI6MTYyMjYzMjQ5MSwiZXhwIjoxNjIyNjM5OTkxLCJhaW8iOiJBVlFBcS84VEFBQUFrMlUyQ1pBNFR0Skk5YWxUUll1MGxvT2VmLzFhOE10OUg0c0Z0M2lzV2pjVHdHTEFtQ3JNZkkvSDZwK1RsMnpnQnRvRVdRSVcvcnh0Q0hTQVBVUjZaTDhDNTZJOUM5Qm03VlVMcFVPOUExRT0iLCJhenAiOiI1ZTNjZTZjMC0yYjFmLTQyODUtOGQ0Yi03NWVlNzg3ODczNDYiLCJhenBhY3IiOiIwIiwibmFtZSI6IkNoYW5ha2EgU2FuamVld2EiLCJvaWQiOiIzNmMyNDY5ZS02N2Y2LTRkM2QtYTYyMS0zOTg3NWFiNDQ3MDUiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJDaGFuYWthQG9uc2hvcGxrLm9ubWljcm9zb2Z0LmNvbSIsInJoIjoiMC5BWEFBY0o1LVpHM3NfRU9KWW9rdmtUVmxJY0RtUEY0Zks0VkNqVXQxN25oNGMwWndBSVEuIiwic2NwIjoiYWNjZXNzX2FzX3VzZXIiLCJzdWIiOiJibXlmTk15aDhWOFRpSWlNNGt0TnlCTmpReVRzakZUUmRMTEdPaVp3d0pVIiwidGlkIjoiNjQ3ZTllNzAtZWM2ZC00M2ZjLTg5NjItODkyZjkxMzU2NTIxIiwidXRpIjoic01BdXhlU2piRUNuOWdDY2xLNDVBdyIsInZlciI6IjIuMCJ9.Q7A4VL4Ys8Osx0JVaxv8LD1uq0JUzkxzU6uwUC6EomkOGFteRTlNPWzTatm8vVSCEUzztKPiXXsiBxufPH7f5vMhyptGQ3HZ2PGnMAPgxZgRExfgzPHG03wjivOx74BDN_HEFZVhlJ1dun3VjN2oWP1yzz6dAfVxay5ZFu45xJyhKYz-emxYRRpcvwPJh35TccofSmKMR082MVknP-xMKAwGn2FfK3eBis25F7UMJDFwTORLT8Owr1lx5IGz-JO1zCdIuvhHL-LoTi30xDAlmCXuXRE00zlJAfQOFQ4ZvYj3EK79GpYNYK19AZjBqRFd2_UFU2TAXG3etE8OqFEEsg",requested_token_use:"on_behalf_of",scope:a.join(" ")};console.log(n),fetch("https://login.microsoftonline.com/647e9e70-ec6d-43fc-8962-892f91356521/oauth2/v2.0/token",{method:"POST",body:p.a.stringify(n),headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}}).then((function(a){200!==a.status?a.json().then((function(e){t({error:e.error})})):a.json().then((function(t){console.log(t.access_token),e(t.access_token)}))}))}))}var k=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={client_token:"client token",server_token:"server token",profile:{},theme:"theme"},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;f.initialize(),f.getContext((function(e){e&&e.theme?(console.log(e),this.setState({theme:e.theme})):console.log("no theme")})),b().then((function(e){e.ok?console.log(e.json()):console.log(e.error)})),new Promise((function(e,t){console.log("1. Get auth token from Microsoft Teams"),f.authentication.getAuthToken({successCallback:function(t){e(t)},failureCallback:function(e){t("Error getting token: "+e),console.log("Error getting token")}})})).then((function(t){return e.setState((function(e,a){return{client_token:t}})),new Promise((function(e,t){f.getContext((function(a){b().then((function(e){if(e.ok)return e.json();t(e.error)})).then((function(a){a.error?t(a.error):e(a)}))}))}))})).then((function(t){return console.log(t),e.setState((function(e,a){return{server_token:t}})),fetch("https://graph.microsoft.com/v1.0/me/",{method:"GET",headers:{accept:"application/json",authorization:"bearer "+t},mode:"cors",cache:"default"}).then((function(e){if(e.ok)return e.json();throw"Error ".concat(e.status,": ").concat(e.statusText)})).then((function(e){return e}))})).then((function(t){console.log(t),e.setState((function(e,a){return{profile:t}}))})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("div",{className:"container"},l.a.createElement("h5",{className:"text-left"},"Local Demo 2 tokens")),l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},"Theme"),l.a.createElement("div",{className:"col-sm-9"},this.state.theme)),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},"client token"),l.a.createElement("div",{className:"col-sm-9"},this.state.client_token)),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},"server token"),l.a.createElement("div",{className:"col-sm-9"},this.state.server_token)),l.a.createElement("br",null),l.a.createElement("div",{className:"container"},l.a.createElement("h5",{className:"text-left"},"Profile")),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("p",null,"Name:"),l.a.createElement("p",null,"Email:"),l.a.createElement("p",null,"id:")),l.a.createElement("div",{className:"col-sm-9"},l.a.createElement("p",null,this.state.profile.displayName),l.a.createElement("p",null,this.state.profile.mail),l.a.createElement("p",null,this.state.profile.id)))))}}]),t}(l.a.Component),x=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={client_token:"client token",server_token:"server token",profile:{},theme:"theme",name:"name",context:{}},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("theme");e?alert("Theme is "+e):alert("No theme local storage");var t=this;return f.initialize(),f.getContext((function(e){e&&e.theme?(console.log(e),t.setState({theme:e.theme,context:e}),localStorage.setItem("theme",e.theme)):console.log("no theme")})),f.authentication.getUser((function(e){console.log("getUser"),console.log(e)})),console.log("showNotification"),f.showNotification((function(e){console.log("getUserJoinedTeams"),console.log(e)})),new Promise((function(e,a){fetch("http://localhost:3333/hrm/auth",{method:"POST",body:p.a.stringify({UserID:"chamath",UserPassword:"chamath123*",ClientID:1,GroupID:1}),headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}}).then((function(n){console.log(n),200!==n.status?n.json().then((function(e){console.log("error notification"),a({error:e.error})})):n.json().then((function(a){console.log(a),t.setState({profile:a.Data}),e(a)}))})).catch((function(e){console.log(e)}))}))}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("div",{className:"container"},l.a.createElement("h5",{className:"text-left"},"Notification 4"),l.a.createElement("div",{className:"m-b-lg",id:"ProfileBriefWidget"},l.a.createElement("div",{className:"widget-head-color-box navy-bg p-lg text-center m-t-none"},l.a.createElement("div",{className:"m-b-md"},l.a.createElement("h2",{className:"font-bold no-margins"},this.state.profile.EmpFullName," "),l.a.createElement("small",{"data-bind":"text: ProfileBrief.Designation()"},"Software Engineer")),l.a.createElement("img",{className:"img-circle circle-border-sm img-lg  m-b-md",alt:""}),l.a.createElement("div",{className:"hbs_Socialmedia"},l.a.createElement("ul",{className:"list-inline"},l.a.createElement("li",{className:"hbsicons"}," ",l.a.createElement("a",{href:"#"},l.a.createElement("span",null,l.a.createElement("i",{className:"fa fa-facebook fa-lg "})))),l.a.createElement("li",{className:"hbsicons"}," ",l.a.createElement("a",{href:"#"},l.a.createElement("span",null,l.a.createElement("i",{className:"fa fa-twitter fa-lg "}))),"  "),l.a.createElement("li",{className:"hbsicons"}," ",l.a.createElement("a",{href:"#"},l.a.createElement("span",null,l.a.createElement("i",{className:"fa fa-linkedin fa-lg "})))," "),l.a.createElement("li",{className:"hbsicons"},l.a.createElement("a",{href:"#"}," ",l.a.createElement("span",null,l.a.createElement("i",{className:"fa fa-skype fa-lg "}))),"  ")))),l.a.createElement("div",{className:"widget-text-box"},l.a.createElement("dl",{className:"row m-b-xs"},l.a.createElement("div",{className:"col-sm-6 "},l.a.createElement("dt",null,"Employee Number :")),l.a.createElement("div",{className:"col-sm-6 text-left"},l.a.createElement("dd",{className:"m-b-xs"},l.a.createElement("span",{"data-bind":"text: ProfileBrief.EmployeeDisplayNumber()"},this.state.profile.EmpNo)))),l.a.createElement("dl",{className:"row m-b-xs","data-bind":"visible: ProfileBrief.ShowMobile"},l.a.createElement("div",{className:"col-sm-6 "},l.a.createElement("dt",null,"Mobile :")),l.a.createElement("div",{className:"col-sm-6 text-left"},l.a.createElement("dd",{className:"m-b-xs"},l.a.createElement("span",{"data-bind":"text: ProfileBrief.Mobile()"},"0717492917")))),l.a.createElement("dl",{className:"row m-b-xs","data-bind":"visible: ProfileBrief.ShowOfficeEmail"},l.a.createElement("div",{className:"col-sm-6 "},l.a.createElement("dt",null,"Email :")),l.a.createElement("div",{className:"col-sm-6 text-left"},l.a.createElement("dd",{className:"m-b-xs"},l.a.createElement("span",{"data-bind":"text: ProfileBrief.OfficeEmail"},"chanakasa@hsenid.lk")))),l.a.createElement("dl",{className:"row m-b-xs","data-bind":"visible: ProfileBrief.ShowAddress"},l.a.createElement("div",{className:"col-sm-6 "},l.a.createElement("dt",null,"Address :")),l.a.createElement("div",{className:"col-sm-6 text-left"},l.a.createElement("dd",{className:"m-b-xs"},l.a.createElement("span",{"data-bind":"text: ProfileBrief.Address"},"31/A, Handagiriya, Balangoda")))),l.a.createElement("dl",{className:"row m-b-xs","data-bind":"visible: ProfileBrief.ShowConfigCol1"},l.a.createElement("div",{className:"col-sm-6 "},l.a.createElement("dt",{"data-bind":"text:ProfileBrief.ConfigCol1"},"null :")),l.a.createElement("div",{className:"col-sm-6 text-left"},l.a.createElement("dd",{className:"m-b-xs"},l.a.createElement("span",{"data-bind":"text: ProfileBrief.ConfigCol1Value"})))),l.a.createElement("dl",{className:"row m-b-xs","data-bind":"visible: ProfileBrief.ShowConfigCol2"},l.a.createElement("div",{className:"col-sm-6 "},l.a.createElement("dt",{"data-bind":"text:ProfileBrief.ConfigCol2"},"null :")),l.a.createElement("div",{className:"col-sm-6 text-left"},l.a.createElement("dd",{className:"m-b-xs"},l.a.createElement("span",{"data-bind":"text: ProfileBrief.ConfigCol2Value"}))))))))}}]),t}(l.a.Component),w=a(19),j=a(16),y=a(12),O=a.n(y),T=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(w.a)({},e.target.name,e.target.value))},a.logout=function(){O.a.remove("token")},a.loadnotification=function(){var e=Object(j.a)(a),t={token:localStorage.getItem("token"),empnumber:localStorage.getItem("empNumber")};fetch("http://localhost/MsTeam/api/HsEmployee/GetTypeWisePendingSummary",{method:"POST",body:p.a.stringify(t),headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){200!==t.status?t.json().then((function(e){console.log("error notification")})):t.json().then((function(t){var a=t;e.setState({data:t}),console.log(a)}))})).catch((function(e){console.log(e)}))},a.state={password:"",userId:"",data:[]},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){O.a.get("token")||alert("you should log in.");var e=this,t={token:O.a.get("token"),empnumber:O.a.get("empNumber")};fetch("http://localhost/MsTeam/api/HsEmployee/GetTypeWisePendingSummary",{method:"POST",body:p.a.stringify(t),headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){200!==t.status?t.json().then((function(e){console.log("error notification")})):t.json().then((function(t){var a=t;e.setState({data:t}),console.log(a)}))})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"row justify-content-center"},l.a.createElement("div",{className:"col-10"},l.a.createElement("h5",{className:"text-right"},"Work flow notification"),l.a.createElement("br",null),l.a.createElement("button",{onClick:this.logout,type:"button",className:"btn btn-primary btn-sm"},"Log out"),l.a.createElement("br",null),l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"row"},this.state.data.map((function(e,t){return l.a.createElement("div",{id:t,className:"col-sm"},l.a.createElement("h6",null,e.TypeName),l.a.createElement("p",null,e.ModuleCode),l.a.createElement("p",null,e.PendingAppCount),l.a.createElement("p",null,e.PendingDelCount),l.a.createElement("p",null,e.TypeCode))}))))))))}}]),t}(l.a.Component),C=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(w.a)({},e.target.name,e.target.value))},a.submitform=function(){var e=Object(j.a)(a),t={UserID:a.state.userId,UserPassword:a.state.password,ClientID:1,GroupID:1};fetch("http://localhost/MsTeam/api/HsEmployee/authclientuser",{method:"POST",body:p.a.stringify(t),headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}}).then((function(t){console.log(t),200!==t.status?t.json().then((function(e){console.log("error notification")})):t.json().then((function(t){var n=t.Data;e.setState({profile:t.Data}),O.a.set("token",n.Token,{expires:7}),O.a.set("empNumber",n.EmpNoEncrypted,{expires:7}),O.a.set("userName",n.EmpFullName,{expires:7}),a.componentDidMount()}))})).catch((function(e){console.log(e)}))},a.state={password:"",userId:"",context:{},logged:!1},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){O.a.get("token")?this.setState({logged:!0}):(alert("you should log in."),this.setState({logged:!1}))}},{key:"render",value:function(){return l.a.createElement("div",null,this.state.logged?l.a.createElement(T,null):l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"row justify-content-center"},l.a.createElement("div",{className:"col-5"},l.a.createElement("h5",{className:"text-center"},"Sign in"),l.a.createElement("br",null),l.a.createElement("form",null,l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{for:"exampleInputEmail1"},"User Id "),l.a.createElement("input",{type:"text",className:"form-control",name:"userId",value:this.state.userId,onChange:this.handleChange})),l.a.createElement("br",null),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{for:"exampleInputPassword1"},"Password"),l.a.createElement("input",{type:"password",className:"form-control",name:"password",value:this.state.password,onChange:this.handleChange})),l.a.createElement("br",null),l.a.createElement("button",{onClick:this.submitform,type:"button",className:"btn btn-primary"},"Submit"))))))}}]),t}(l.a.Component);var S=function(){return l.a.createElement("div",{className:"App"},l.a.createElement(r.a,null,l.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},l.a.createElement("div",{className:"container-fluid"},l.a.createElement(r.b,{className:"navbar-brand",to:"/"},"Hsenid Biz"),l.a.createElement("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},l.a.createElement("span",{className:"navbar-toggler-icon"})),l.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNav"},l.a.createElement("ul",{className:"navbar-nav"},l.a.createElement("li",{className:"nav-item"},l.a.createElement(r.b,{className:"nav-link",to:"/React-h-biz"},"Home")),l.a.createElement("li",{className:"nav-item"},l.a.createElement(r.b,{className:"nav-link",to:"/React-h-biz/demo2"},"Demo2")),l.a.createElement("li",{className:"nav-item"},l.a.createElement(r.b,{className:"nav-link",to:"/React-h-biz/notification"},"Notification")),l.a.createElement("li",{className:"nav-item"},l.a.createElement("a",{className:"nav-link disabled",href:"#",tabindex:"-1","aria-disabled":"true"},"Disabled")))))),l.a.createElement(s.c,null,l.a.createElement(s.a,{exact:!0,path:"/React-h-biz"},l.a.createElement("div",null,l.a.createElement(C,null))),l.a.createElement(s.a,{exact:!0,path:"/React-h-biz/demo2"},l.a.createElement("div",null,l.a.createElement(g,null),l.a.createElement(k,null))),l.a.createElement(s.a,{path:"/React-h-biz/notification"},l.a.createElement(x,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[28,1,2]]]);
//# sourceMappingURL=main.b26ce537.chunk.js.map